<% stages=["Submitted", "Criminal Passed", "Child Abuse Passed", "Picked Up/Mailed"] %>
<% num_stages = 4 %>
<div class="row">
  <div class="small-9 columns">
    <h1>My Background Check Status</h1>
    <br>
  </div>
  <div class="small-3 columns">
    <% if current_user.admin?%>
       <%=link_to fa_icon("edit"), edit_bg_check_path, class:"edit-icon" %>
    <% end %>
  </div>
</div>

<div class="row">
  <div class="small-12 columns">
    <h3>Current Step</h3>
  </div>
</div>
<div class="row">  
    <% for i in 0..(num_stages-1) %>
        <div class="small-3 columns text-center">
         <strong><%= stages[i] %></strong>
        </div>
    <% end %>
  </div>
</div>

<!-- i represents which stage (not related to ith element of stages) -->
<div class="row">
      <div class="small-3 columns text-center">
        <% if @bg_check.status == 0 %>
          <% if @bg_check.issues.active.empty? %>
            <%= fa_icon('ellipsis-h') %>
          <% else %>
            <%= fa_icon('warning', class: 'warning-icon') %>
          <% end %>
        <% else %>
          <%= fa_icon('check', class: 'check_icon') %>
        <% end %>
      </div>
      <div class="small-3 columns text-center">
        <% if @bg_check.status > 0 %>
          <% if @bg_check.status == 1 %>
            <% if @bg_check.issues.active.empty? %>
              <%= fa_icon('ellipsis-h') %>
            <% else %>
              <%= fa_icon('warning', class: 'warning-icon') %>
            <% end %>
          <% else %>
            <%= fa_icon('check', class: 'check_icon') %>
          <% end %>
        <% end %>
      </div>
      <div class="small-3 columns text-center">
        <% if @bg_check.status > 1 %>
          <% if @bg_check.status == 2 %>
            <% if @bg_check.issues.active.empty? %>
              <%= fa_icon('ellipsis-h') %>
            <% else %>
              <%= fa_icon('warning', class: 'warning-icon') %>
            <% end %>
          <% else %>
            <%= fa_icon('check', class: 'check_icon') %>
          <% end %>
        <% end %>
      </div>
      <div class="small-3 columns text-center">
        <% if @bg_check.status > 2 %>
          <% if @bg_check.status == 3 %>
            <% if @bg_check.issues.active.empty? %>
              <%= fa_icon('ellipsis-h') %>
            <% else %>
              <%= fa_icon('warning', class: 'warning-icon') %>
            <% end %>
          <% else %>
            <%= fa_icon('check', class: 'check_icon') %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>

    <br>
    <br>
    <br>
</div>

<% if !@bg_check.issues.active.empty? %>
<div class="row">
  <div class="small-12 columns">
    <h3>Issue(s)</h3>
      <table>
        <thead>
          <tr>
            <th>Category</th>
            <th>Description</th>
            <%if current_user.admin? %>
              <th></th>
            <%end%>
          </tr>
        </thead>
        <tbody>
          <% @bg_check.issues.each do |issue| %>
            <tr>
              <td>
                <%=issue.category%>
              </td>
              <td>
                <%=issue.description%>
              </td>
              <%if current_user.admin?%>
                <td><!-- icon based on bg_check status -->
                  <!--CORY I'LL LET YOU USE THIS SPACE FOR RESOLVE -->
                </td>
              <%end%>
            </tr>
          <% end %>
        </tbody>
      </table>
  </div>
</div>
<% end %>

<div class="row">
  <div class="small-12 columns">

    <% if @bg_check.status == 5 %>
          <%= render 'excluded' %>
    <% elsif !@bg_check.issues.active.empty? %>
          <%= render 'has_issues' %>
    <% elsif @bg_check.status == 0 %>
          <%= render 'requested' %>
    <% elsif @bg_check.status == 1 %>
          <%= render 'submitted' %>
    <% elsif @bg_check.status == 2 %>
          <%= render 'crim_passed' %>
    <% elsif @bg_check.status == 3 %>
          <%= render 'all_passed'%>
    <% elsif @bg_check.status == 4 %>
          <%= render 'picked_up_mailed' %>
    <% end %>
  </div>
</div>

<br>




